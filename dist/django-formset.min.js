/*! Django Formset - v0.1.0 - 2014-02-24
* https://github.com/mbertheau/jquery.django-formset
* Copyright (c) 2014 Markus Bertheau; Licensed MIT */
var FormsetError,__hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},__bind=function(a,b){return function(){return a.apply(b,arguments)}};FormsetError=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b}(Error),function(a){a.fn.djangoFormset=function(b){return new a.fn.djangoFormset.Formset(this,b)},a.fn.djangoFormset.Formset=function(){function b(b,c){var d,e;if(e=a.extend({},a.fn.djangoFormset.default_options,c),this.prefix=e.prefix,0===b.length)throw new FormsetError("Empty selector.");if(this.totalForms=b.find("#id_"+this.prefix+"-TOTAL_FORMS"),0===this.totalForms.length)throw new FormsetError("Management form field 'TOTAL_FORMS' not found for prefix "+this.prefix+".");if("TABLE"===b.prop("tagName")&&(b=b.children("tbody")),this.template=b.children(".empty-form"),0===this.template.length)throw new FormsetError("Can't find template (looking for .empty-form)");d=b.children().not(".empty-form"),this.forms=function(c){return function(){var d,e,f,g,h;for(g=b.children(":visible"),h=[],e=0,f=g.length;f>e;e++)d=g[e],h.push(new a.fn.djangoFormset.Form(d,c));return h}}(this)(),this.insertAnchor=b.children().last()}return b.prototype._setFormIndex=function(b,c){return b.find("input,select,textarea,label").each(function(){var b,d,e,f,g;for(d=a(this),g=["for","id","name"],e=0,f=g.length;f>e;e++)b=g[e],d.attr(b)&&d.attr(b,d.attr(b).replace("__prefix__",c))})},b.prototype.addForm=function(){var b;b=this.template.clone().removeClass("empty-form"),b.insertAfter(this.insertAnchor),this.insertAnchor=b,this.forms.push(new a.fn.djangoFormset.Form(b,this)),this.totalForms.val(parseInt(this.totalForms.val())+1),this._setFormIndex(b,this.totalForms.val()-1)},b.prototype.deleteForm=function(a){var b;b=this.forms[a],b["delete"](),this.forms=this.forms.slice(0,+a+1||9e9).concat(this.forms.slice(a+1))},b}(),a.fn.djangoFormset.Form=function(){function a(a,b){this.elem=a,this.formset=b,this["delete"]=__bind(this["delete"],this)}return a.prototype["delete"]=function(){var a,b,c;b="#{@formset.prefix}-#{index}-DELETE",a=this.elem.find("input:hidden[name='"+b+"']").get(0),c=null!=a,c?this._deleteInitial():this._deleteNew()},a.prototype._deleteNew=function(){return this.elem.remove(),this.formset.totalForms.val(parseInt(this.formset.totalForms.val())-1)},a}(),a.fn.djangoFormset.default_options={prefix:"form"}}(jQuery);